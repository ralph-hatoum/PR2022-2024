<!doctype html>
<html lang="en">




  <head>
    <meta charset="UTF-8"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width,initial-scale=1" name=viewport />

    <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
    <link rel="manifest" href="../site.webmanifest">
    <link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">

    <meta name="msapplication-TileColor" content="#15154f">
    <meta name="theme-color" content="#ffffff">

    <link rel="alternate feed" href="https://ipfscluster.io/news/index.xml" type="application/rss+xml"  title="IPFS Cluster News" />

    
    <meta property="og:type" content="website" />
    <meta property="og:url" content="" />
    <meta property="og:title" content="Release process" />
    <meta property="og:description" content="Pinset orchestration for IPFS" />
    <meta property="og:image" content="https://ipfscluster.io/og-image.jpg" />
    <meta property="og:image:width" content="279">
    <meta property="og:image:height" content="279">

    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:domain" value="ipfscluster.io" />
    <meta name="twitter:title" value="Release process" />
    <meta name="twitter:description" value="Pinset orchestration for IPFS" />
    <meta name="twitter:image" content="https://ipfscluster.io/og-image.jpg" />
    <meta name="twitter:url" value="" />

    <title>Release process - Pinset orchestration for IPFS</title>

    <script src="../js/jquery-2.x.min.js"></script>

    <link rel="stylesheet" href="../css/nucleus.css">
    <link rel="stylesheet" href="../css/fontawesome-all.min.css">
    <link rel="stylesheet" href="../css/hybrid.css">
    <link rel="stylesheet" href="../css/featherlight.min.css">
    <link rel="stylesheet" href="../css/perfect-scrollbar.min.css">
    <link rel="stylesheet" href="../css/auto-complete.css">
    <link rel="stylesheet" href="../css/hybrid.css">
    <link rel="stylesheet" href="../css/fontawesome-all.min.css">
    <link rel="stylesheet" href="../css/tachyons.min.css"/>
    <link rel="stylesheet" href="../fonts/fonts.css"/>
    <script async defer src="../buttons.js"></script>
    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono|IBM+Plex+Sans" rel="stylesheet">
    <link rel="stylesheet" href="../css/theme.css">
    <link rel="stylesheet" href="../css/hugo-theme.css">
    <link rel="stylesheet" href="../css/main.css"/>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>

    
<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-96910779-7', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>


  </head>

  <body class="w-100 bg-dark_blue">

    




  <header class="w-100 pa3 pa4-ns ph2 ph5-ns">
    <div class="db dt-l mw9 center w-100">
      <div class="dtc-l tc v-mid w-100 w-40-ns w-100-m">
        <a href="../" class="dtc-l f5 f4-ns fw6 mt0 mb1 link header-title" title="Home"> 
          <div class="dtc ml0 pl0 v-mid">
            <img src="../android-chrome-192x192.png" alt="IPFS Cluster logo" />
          </div>
          <div class="dtc v-mid">
            IPFS <span class="fw5">Cluster</span>
          </div>
        </a>
      </div>
      <nav id="navbar" class="db dtc-l v-mid w-100 tc tc-m tr-ns mt2 mt0-ns">
  <ul class="mt0 mb0 ml0 list">
    
    <li class="dib nav-link"><a href="../news/" title="">
       
       
       <i class='fa fa-newspaper'></i> 
       
      News</a></li>
    
    <li class="dib nav-link"><a href="../documentation/" title="">
       
       <i class='fa fa-book'></i> 
       
       
      Documentation</a></li>
    
    <li class="dib nav-link"><a href="../download/" title="">
       <i class='fa fa-download'></i> 
       
       
       
      Download</a></li>
    
    <li class="dib nav-link"><a href="../support/" title="">
       
       
       
       <i class='fa fa-question-circle'></i> 
      Support</a></li>
    
    <li class="dib nav-link"><a target="_blank" href="https://github.com/ipfs-cluster/ipfs-cluster"><i class='fab fa-github'></i> Github</a></li>
  </ul>
</nav>

    </div>
  </header>


    




<div id="body" class="bt b--black-10 bg-white black-90 pb4 pb5-ns">
  <div class="mw9 center ph4">
    <div class="cf">

    
    <nav id="sidebar" class=" fl w-100 w-third-ns w-100-m pa2">

    
    
      <div id="header-wrapper">
        
            <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../js/lunr.min.js?1678266312"></script>
<script type="text/javascript" src="../js/auto-complete.js?1678266312"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/ipfscluster.io";
    
</script>
<script type="text/javascript" src="../js/search.js?1678266312"></script>

        
      </div>

      <div class="highlightable">
        <ul class="topics">
          
          
          
          
          
          
          
        </ul>
      </div>
    </nav>





    <div id="overlay"></div>
    

    
    <div id="main-content" class="padding highlightable fl w-100 w-two-thirds-ns w-100-m pa2">
      
        <div id="top-bar">

            
            <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                <span id="sidebar-toggle-span">
                    <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                      <i class="fas fa-bars"></i>
                    </a>
                </span>
                <span class="links">
               
               
                  
                  
  
  
    
    
  
  
    <a href='../'>IPFS Cluster</a> > Release process
  

  

               
                </span>
            </div>

        </div> 
      

      

      <div id="body-inner" class="page-with-sidenav">
          
          
          
        

<h1 id="release-process">Release process</h1>

<p>Tasks that need to happen for a release:</p>

<h2 id="preparation">Preparation</h2>

<ul>
<li>Open release issue with the Release tag and mention all issues and tickets
that will go on that release
(<a href="https://github.com/ipfs-cluster/ipfs-cluster/issues/620">https://github.com/ipfs-cluster/ipfs-cluster/issues/620</a>). It helps backtrack when
things happening from the issues.</li>
<li>Write the changelog entry for the release (copy from previous) and commit to
branch:

<ul>
<li>Summary of what&rsquo;s happening in the release</li>
<li>List of features, bugs</li>
<li>Configuration changes and upgrades notices (note comment at the bottom of
the file about how to write @issuelinks and replace them with sed)</li>
</ul></li>
<li>PR to the website with all the necessary documentation changes

<ul>
<li>Special attention to documentation changes (/configuration section)</li>
<li>Special attention to behaviour changes that are described somewhere in the
docs</li>
<li>Add an entry to <code>news</code> about the new release. Explain it for humans. Thank
main contributors.</li>
<li>Updaqte the <code>Updated tp version x.x.x</code> string</li>
</ul></li>
</ul>

<h2 id="make-a-release-candidate">Make a release candidate</h2>

<ul>
<li>Merge all code that needs to be merged for the release. Double check on
master:

<ul>
<li>It builds.</li>
<li><code>gx deps dupes</code> is empty.</li>
<li>All the dependency tree is pinned (<code>gx2cluster</code>).</li>
<li><code>ipfs-cluster-service</code> starts with a configuration file from the last
release just fine.</li>
<li>Depending on what has changed in the release, it might be useful to run a
test deployment of cluster and make sure things look fine.</li>
<li>Make sure to start a peer at least and check that there is no weird log
messages on boot.</li>
</ul></li>
<li>Fully clean your repository workspace: there should not be anything in it
that is not part of the repository (untracked files).</li>
<li>Call the <code>/release.sh 0.x.x-rc1</code> on master:

<ul>
<li>IPFS daemon must be started before.</li>
<li>git must be able to sign commits.</li>
<li><code>gx</code> must be installed in the system.</li>
<li>It seds and replaces the version numbers in the code, signs and commits
the new Release, tags the new Release with an annotated signed tag which
includes the full changelog since last stable release, and gx-releases the
whole thing (which again, signs the gx-release commit).</li>
<li>Triple-check all is well. If not, remove tags, reset to <code>origin/master
--hard</code>.</li>
<li><code>git push origin master --tags</code> NO TURNING BACK FROM THIS POINT.</li>
<li>Pin the new ipfs-cluster gx hash.</li>
</ul></li>
<li>Publish the new release to <code>dist.ipfs.io</code>:

<ul>
<li>Keep your cluster repository in master and don&rsquo;t touch anything in it.</li>
<li>ipfs daemon must be running.</li>
<li>Check out <code>ipfs/distributions</code>. Make a branch. Update the <code>versions</code> file
and add the new RC (MUST HAVE A NEW LINE AT THE END). <code>make clean</code> -&gt;
<code>make publish</code>. This will take a while.</li>
<li><code>ipfs object diff /ipns/dist.ipfs.io (tail -n1 versions )</code> should only
show changes in cluster folders.</li>
<li>Commit and push the branch, add the <code>ipfs object diff output</code> to the PR,
wait for travis to be green and merge.</li>
<li>Pin the new dist hash.</li>
<li>Update DNSSimple entry for <code>dist.ipfs.io</code> to the new hash.</li>
</ul></li>
<li>Deploy storage cluster with the new release:

<ul>
<li><code>ipfs-cluster-infra/ansible</code> repo, update the configurations and run
<code>ansible</code>.</li>
<li>If configurations changed, you may need to update <code>ansible-ipfs-cluster</code>
submodule.</li>
</ul></li>
<li>Update the pinbot to the new cluster version:

<ul>
<li><code>ipfs/pinbot-irc</code> and <code>gx update ipfs-cluster
github.com/ipfs-cluster/ipfs-cluster</code>.</li>
<li>Any <code>client</code> API changes might need to fix the pinbot code.</li>
<li>Commit and push.</li>
<li>Deploy the pinbot by updated the ref commit in
<code>ipfs-cluster-infra/ansible</code>.</li>
</ul></li>
<li>Announce the RC to the world via twitter.</li>
</ul>

<h2 id="testing">Testing</h2>

<ul>
<li>This is the triple check that things should be working as they should.  Most
of this testing should have happened locally before making the RC.</li>
<li>Storage cluster started just fine.</li>
<li>Pinbot works with the new cluster and in the new pinbot version.</li>
<li>Test that things that were introduced are actually doing what they should be
doing (again).</li>
<li>Test that bugfixes are actually fixed (again).</li>
<li>Depending on the introduced changes, let the RC rest for a couple of days.</li>
</ul>

<h2 id="make-the-final-release">Make the final release</h2>

<ul>
<li>Set the right date in the changelog branch. Ensure all issue links are
there.  Merge.</li>
<li>Close <code>Release issue</code>.</li>
<li>Set the right date in the <code>news</code> post in the website.</li>
<li>If there have been changes since the RC, double check the same things on
master as with RC.</li>
<li>Fully clean your repo space as with the RC.</li>
<li>Call <code>/release.sh 0.x.x</code>. Same subtasks as with the RC.</li>
<li>Publish the new release to <code>dist.ipfs.io</code>. Same procedure except:

<ul>
<li>Need to update the <code>current</code> files to the new version. THEY NEED TO HAVE A
NEW LINE AT THE END.</li>
</ul></li>
<li>Merge the documentation for the website.

<ul>
<li>Check that Jenkins actually built the website and published it.</li>
<li>Pin the new hash.</li>
</ul></li>
<li>Deploy storage cluster with the stable.</li>
<li>Update the pinbots to the stable.</li>
<li>Announce to the world.</li>
</ul>


      </div>

    </div> 
    

  </div>

    <footer class="w-100 pt3 mt5">
  <div class="db dt-l mw9 w-100 ph-1 ph4-ns">
    <div class="db dtc-l tc tc-m tl-ns v-mid w-100 w-40-l">
      <div class="db dtc-l v-mid mb3">
        <p class="f5">Please open issues and submit PRs to this website at <a href="https://github.com/ipfs-cluster/ipfs-cluster-website/issues" target="_blank"><i class='fab fa-github'></i> github.com/ipfs-cluster/ipfs-cluster-website.</a></p>
        <p>IPFS Cluster was started and is sponsored by <a href="https://protocol.ai/">Protocol Labs</a><br/>
        © <a href="https://protocol.ai/" target="_blank">Protocol Labs</a> | Except as <a href="https://protocol.ai/legal/">noted</a>, content licensed <a href="" target="_blank">CC-BY 3.0</a></p>
      </div>
    </div>
    <nav id="navbar" class="db dtc-l v-mid w-100 tc tc-m tr-ns mt2 mt0-ns">
  <ul class="mt0 mb0 ml0 list">
    
    <li class="dib nav-link"><a href="../news/" title="">
       
       
       <i class='fa fa-newspaper'></i> 
       
      News</a></li>
    
    <li class="dib nav-link"><a href="../documentation/" title="">
       
       <i class='fa fa-book'></i> 
       
       
      Documentation</a></li>
    
    <li class="dib nav-link"><a href="../download/" title="">
       <i class='fa fa-download'></i> 
       
       
       
      Download</a></li>
    
    <li class="dib nav-link"><a href="../support/" title="">
       
       
       
       <i class='fa fa-question-circle'></i> 
      Support</a></li>
    
    <li class="dib nav-link"><a target="_blank" href="https://github.com/ipfs-cluster/ipfs-cluster"><i class='fab fa-github'></i> Github</a></li>
  </ul>
</nav>

  </div>
</footer>


  </div>
</div>



    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../js/clipboard.min.js"></script>
    <script src="../js/jquery.sticky.js"></script>
    <script src="../js/featherlight.min.js"></script>
    <script src="../js/html5shiv-printshiv.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../js/modernizr.custom.71422.js"></script>
    <script src="../js/learn.js"></script>
    <script src="../js/hugo-learn.js"></script>

    <link href="../mermaid/mermaid.css" type="text/css" rel="stylesheet" />
    <script src="../mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
  </body>
</html>
